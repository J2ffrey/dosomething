
<% 
@region = params[:region] if !params[:region].nil? && params[:region]!="empty" # 정확한 값이 있다면
@school = params[:school] if !params[:school].nil? && params[:school]!="empty"
@category = params[:category] if !params[:category].nil? && params[:category]!="empty"
@btime = params[:btime] if !params[:btime].nil? && params[:btime]!="empty"
@s_word = params[:s_word] if !params[:s_word].nil? && params[:s_word]!="empty"
%>

<%
        first = 0
        tmp = ""
        check = Proc.new {|x|
            if first == 0
                first = 1
            else
                tmp += " AND "
            end
            tmp += "#{x}"
        }
        
        check.call "name LIKE \"%#{@s_word}%\"" unless @s_word.nil?
        check.call "region_id LIKE \"#{@region}\"" unless @region.nil?
        check.call "school_id LIKE \"#{@school}\"" unless @school.nil?
        check.call "btime_id LIKE \"#{@btime}\"" unless @btime.nil?
        check.call "category_id LIKE \"#{@category}\"" unless @category.nil?
        @bongsa = Bongsa.where("#{tmp}")
%>
<%#= @s_word %>
<%#= @region %>
<%#= @school %>
<%#= @btime %>
<%#= @category %>
<div class="blank"></div>
<div id="ajax_target">
  <div class="bongsas"></div>
</div>

<!--메인 컨텐츠-->
<br>

<div class="col-md-12">
  <center>
    <!--/컨텐츠 카드 시작-->
    <% @bongsa.each do |b| %>
      <a href="/home/bongsa_information/<%= b.id %>">
        <div class="col-md-4 row_main_content">
          <!-------------------------------------------------------------
          아래는 컨텐츠 카드/  [사진 ㄴ> 봉사기간, 봉사명 ]  /코드입니다 
          -------------------------------------------------------------->
          <div class="col-md-12" style="padding:0px;">
            <img src="<%= b.img_main %>" alt="이미지" style="width:100%; height:271px; margin-top:0px;">
            
            <% if b.name.nil? %>
              <center>봉사명이 없습니다.</center>
            <% else %>
              <span class="side_info__title">
                <span><%= b.date_real_start %> ~ <%= b.date_real_end %></span> 
                  <p class="main_content__title">
                <strong><%= b.name %></strong>
                </p>
              </span>
            <% end %>
          </div>
          
          <!-------------------------------------------------------------
              아래는 컨텐츠 카드/  [시간 | 지역 | 디데이]  /코드입니다 
          -------------------------------------------------------------->
          <div class="col-sm-12 col-md-12 col-lg-12" style="padding:0px;">
            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 main_content__content" style="border-right: 1px solid rgba(168, 168, 168, 0.4);"></br>
              <p style="font-size:16px; color:#A8A8A8; margin-bottom:5px;">시간</p>
              <p style="color:#000000; font-size:25px;"><%= b.time_expect_total %></p>
            </div>
            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 main_content__content" style="border-right: 1px solid rgba(168, 168, 168, 0.4);"></br>
              <p style="font-size:16px; color:#A8A8A8; margin-bottom:7px;">지역 </p>
              <p style="color:#000000; font-size:17px;"><%= Region.find(b.region_id).name %></p>
            </div>
            <div class="col-xs-4 col-sm-4 col-md-4 col-lg-4 main_content__content"></br>
              <p style="font-size:16px; color:#A8A8A8; margin-bottom:5px;">D - day</p>
              <p style="color:#000000; font-size:18px; margin-bottom:0px;"><%= b.date_real_start %></p>
              <p style="color:#000000; font-size:18px;"> ~ <%= b.date_real_end %></p>
            </div>  
          </div>
        </div>
      </a>
    <% end %>
    <!--/컨텐츠 카드 끝-->
  </center>
</div>






<!-- 봉사정보 더 보기 코드입니다 -->

</br></br>
  <center>
    <div class="bongsa_more">
      <button id="bongsa_more_btn"><strong>봉사정보 더보기</strong></button>
    </div>
  </center>
</br>

<!-- 무한스크롤 JSON -->
<script type="text/javascript" src="/jquery.jscroll.min.js"></script>
<script type="text/javascript">
   $(function(){
      $("#bongsa_more_btn").on("click", function(){
          $.ajax({
              data :{},
              type:"get",
              url: "",
              datatype:"html",
              success: function(){
                $("#next_content").load(r);
              },
              error: function(){
                    alert("데이터를 가져오지 못하였습니다.");
              };
          });
        });
      });
</script>


<!--봉사달력-->

<br><br>
<center>
  <div class="row">
    <a href = '/calendar/index'>
      <i class="fa fa-calendar-check-o fa-5x"></i>
      <p></p>
      <p style="font-size:30px; text-align:center; color:#512da7;"><b> 봉사달력 보러가기</b></p>
    </a>
  </div>
</center>
<br><br>



<!-- Main Content CSS -->
<%= render :partial => 'style/main_contentcss' %>
